{
    "swagger": "2.0",
    "paths": {
        "/categories": {
            "get": {
                "tags": ["Category"],
                "summary": "获取商品类型列表",
                "parameters": [
                    {
                        "$ref": "#/definitions/Token"
                    },
                    {
                        "in": "query",
                        "name": "query",
                        "required": true,
                        "schema": {
                            "type": "object",
                            "properties": {
                                "parentId": {
                                    "type": "integer",
                                    "description": "用于获取子类目，默认为-1表示顶级分类。加载子类目时将当前id赋给它"
                                }
                            }
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "获取品类成功",
                        "schema": {
                            "type": "object",
                            "description": "商品类型列表获取结果",
                            "properties": {
                                "msg": {
                                    "type": "string",
                                    "description": "成功信息"
                                },
                                "code": {
                                    "type": "string",
                                    "description": "成功编码 0",
                                    "required": true
                                },
                                "data": {
                                    "type": "array",
                                    "description": "商品类型列表",
                                    "items": {
                                        "$ref": "definitions/products/category-item.json"
                                    }
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "tags": ["Category"],
                "summary": "新增商品类别，同级别或子级别",
                "description": "若新增子类别，不会继承父类别的规格；类别中的序号用于同级别展示的顺序，序号越小，排序靠前；序号允许为空，不填默认9999；序号允许重复，序号相同，最后修改时间最新的排在前面；",
                "parameters": [
                    {
                        "$ref": "#/definitions/Token"
                    },
                    {
                        "in": "body",
                        "name": "body",
                        "required": true,
                        "schema": {
                            "type": "object",
                            "properties": {
                                "name": {
                                    "type": "string",
                                    "description": "类别名称"
                                },
                                "sortNum": {
                                    "type": "number",
                                    "description": "排序号，用于同级别展示顺序，越小越在前，若重复则做插入处理"
                                },
                                "remark": {
                                    "type": "string",
                                    "description": "备注"
                                },
                                "dataState": {
                                    "type": "number",
                                    "description": "数据状态，0有效，1无效"
                                },
                                "parentId": {
                                    "type": "number",
                                    "description": "父id，-1表示顶级分类"
                                }
                            }
                        }
                    }
                ],
                "responses": {
                    "201": {
                        "description": "新增商品类别成功，返回该商品",
                        "schema": {
                            "type": "object",
                            "properties": {
                                "msg": {
                                    "type": "string",
                                    "description": "成功信息"
                                },
                                "code": {
                                    "type": "string",
                                    "description": "成功编码 0",
                                    "required": true
                                },
                                "data": {
                                    "$ref": "definitions/products/category-detail.json"
                                }
                            }
                        }
                    }
                }
            }
        },

        "/categories/search": {
            "post": {
                "tags": ["Category"],
                "summary": "搜索分类树",
                "parameters": [
                    {
                        "$ref": "#/definitions/Token"
                    },
                    {
                        "in": "body",
                        "name": "body",
                        "required": true,
                        "description": "搜索名称字数必须>=2，否则不进行检索",
                        "schema": {
                            "type": "object",
                            "properties": {
                                "name": {
                                    "type": "string",
                                    "description": "模糊匹配分类名称"
                                },
                                "dataState": {
                                    "type": "number",
                                    "description": "数据状态，0有效，1无效，默认-1取出有效和无效"
                                }
                            }
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "单个或多个搜索结果的数组，其子元素也为数组，包含根结点到搜索目标结点的一系列对象",
                        "schema": {
                            "type": "object",
                            "properties": {
                                "msg": {
                                    "type": "string",
                                    "description": "成功信息"
                                },
                                "code": {
                                    "type": "string",
                                    "description": "成功编码 0",
                                    "required": true
                                },
                                "data": {
                                    "type": "array",
                                    "description": "商品类型列表",
                                    "items": {
                                        "type": "array",
                                        "items": {
                                            "$ref": "definitions/products/category-item.json"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },

        "/categories/{categoryId}": {
            "get": {
                "tags": ["Category"],
                "summary": "查询单个商品类别的详情",
                "parameters": [
                    {
                        "$ref": "#/definitions/Token"
                    },
                    {
                        "in": "path",
                        "name": "categoryId",
                        "required": true,
                        "type": "integer",
                        "description": "商品类型Id"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "获取类别详情成功",
                        "schema": {
                            "type": "object",
                            "properties": {
                                "msg": {
                                    "type": "string",
                                    "description": "成功信息"
                                },
                                "code": {
                                    "type": "string",
                                    "description": "成功编码 0",
                                    "required": true
                                },
                                "data": {
                                    "$ref": "definitions/products/category-detail.json"
                                }
                            }
                        }
                    }
                }
            },
            "put": {
                "tags": ["Category"],
                "summary": "修改商品类别信息",
                "parameters": [
                    {
                        "$ref": "definitions/search/token.json"
                    },
                    {
                        "in": "path",
                        "name": "categoryId",
                        "required": true,
                        "type": "integer",
                        "description": "商品类型Id"
                    },
                    {
                        "in": "body",
                        "name": "body",
                        "required": true,
                        "schema": {
                            "type": "object",
                            "properties": {
                                "name": {
                                    "type": "string",
                                    "description": "类别名称"
                                },
                                "sortNum": {
                                    "type": "number",
                                    "description": "排序号，用于同级别展示顺序，越小越在前，若重复则做插入处理"
                                },
                                "remark": {
                                    "type": "string",
                                    "description": "备注"
                                },
                                "dataState": {
                                    "type": "number",
                                    "description": "数据状态，0有效，1无效"
                                }
                            }
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "修改商品类型成功，返回该商品",
                        "schema": {
                            "type": "object",
                            "properties": {
                                "msg": {
                                    "type": "string",
                                    "description": "成功信息"
                                },
                                "code": {
                                    "type": "string",
                                    "description": "成功编码 0",
                                    "required": true
                                },
                                "data": {
                                    "$ref": "definitions/products/category-detail.json"
                                }
                            }
                        }
                    }
                }
            },
            "delete": {
                "tags": ["Category"],
                "summary": "删除商品类别",
                "description": "有子类及该类别下存在商品时不能被删除，删除分类时一并清除相关关联规格信息",
                "parameters": [
                    {
                        "$ref": "definitions/search/token.json"
                    },
                    {
                        "in": "path",
                        "name": "categoryId",
                        "required": true,
                        "type": "integer",
                        "description": "商品类型Id"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "删除商品类别成功",
                        "schema": {
                            "type": "object",
                            "properties": {
                                "msg": {
                                    "type": "string",
                                    "description": "成功信息"
                                },
                                "code": {
                                    "type": "string",
                                    "description": "成功编码 0",
                                    "required": true
                                }
                            }
                        }
                    }
                }
            }
        },

        "/categories/{categoryId}/specifications": {
            "get": {
                "tags": ["Category"],
                "summary": "类别下的已关联规格查询",
                "parameters": [
                    {
                        "$ref": "definitions/search/token.json"
                    },
                    {
                        "in": "path",
                        "name": "categoryId",
                        "required": true,
                        "type": "integer",
                        "description": "商品类型Id"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "已关联规格获取成功",
                        "schema": {
                            "type": "object",
                            "properties": {
                                "msg": {
                                    "type": "string",
                                    "description": "成功信息"
                                },
                                "code": {
                                    "type": "string",
                                    "description": "成功编码 0",
                                    "required": true
                                },
                                "data": {
                                    "type": "array",
                                    "description": "规格列表，默认规格序号降序排序",
                                    "items": {
                                        "type": "object",
                                        "description": "单个规格",
                                        "properties": {
                                            "isRequired": {
                                                "type": "number",
                                                "description": "是否必须，0是，1否"
                                            },
                                            "id": {
                                                "type": "number",
                                                "description": "规格ID"
                                            },
                                            "name": {
                                                "type": "string",
                                                "description": "规格名称"
                                            },
                                            "num": {
                                                "type": "string",
                                                "description": "规格序号"
                                            },
                                            "status": {
                                                "type": "number",
                                                "description": "规格状态，0有效，1无效，2删除"
                                            },
                                            "valueList": {
                                                "type": "array",
                                                "items": {
                                                    "type": "object",
                                                    "properties": {
                                                        "id": {
                                                            "type": "number",
                                                            "description": "属性ID"
                                                        },
                                                        "name": {
                                                            "type": "string",
                                                            "description": "属性名称"
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },

        "/categories/{categoryId}/specifications/clean": {
            "post": {
                "tags": ["Category"],
                "summary": "批量清除关联",
                "parameters": [
                    {
                        "$ref": "definitions/search/token.json"
                    },
                    {
                        "in": "path",
                        "name": "categoryId",
                        "required": true,
                        "type": "integer",
                        "description": "商品类型Id"
                    },
                    {
                        "in": "body",
                        "name": "body",
                        "required": true,
                        "description": "批量修改",
                        "schema": {
                            "type": "array",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "id": {
                                        "type": "number",
                                        "description": "规格ID"
                                    }
                                }
                            }
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "清除关联成功",
                        "schema": {
                            "type": "object",
                            "properties": {
                                "msg": {
                                    "type": "string",
                                    "description": "成功：已清除；失败：[规格名称, ...] 清除失败"
                                },
                                "code": {
                                    "type": "string",
                                    "description": "成功：0; 失败：1001",
                                    "required": true
                                }
                            }
                        }
                    }
                }
            }
        },

        "/categories/specifications/link": {
            "post": {
                "tags": ["Category"],
                "summary": "批量关联规格，设置必要性",
                "parameters": [
                    {
                        "$ref": "definitions/search/token.json"
                    },
                    {
                        "in": "body",
                        "name": "body",
                        "required": true,
                        "description": "批量关联，必须设置必要性",
                        "schema": {
                            "type": "object",
                            "properties": {
                                "categoryId": {
                                    "type": "number",
                                    "description": "类别ID，关联到该类别下"
                                },
                                "itemList": {
                                    "type": "array",
                                    "items": {
                                        "type": "object",
                                        "properties": {
                                            "id": {
                                                "type": "number",
                                                "required": true,
                                                "description": "规格ID"
                                            },
                                            "isRequired": {
                                                "type": "number",
                                                "required": true,
                                                "description": "是否必须，0是，1否"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "修改规格成功",
                        "schema": {
                            "type": "object",
                            "properties": {
                                "msg": {
                                    "type": "string",
                                    "description": "成功：已关联；失败：[规格名称, ...] 关联失败"
                                },
                                "code": {
                                    "type": "string",
                                    "description": "成功：0; 失败：1001",
                                    "required": true
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}
